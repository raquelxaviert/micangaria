{% comment %}
  Blog template for miçangaria
{% endcomment %}

<div class="container py-12">
  <!-- Blog Header -->
  <div class="text-center mb-12">
    <h1 class="headline text-primary mb-4" style="font-size: 2.5rem;">{{ blog.title }}</h1>
    {% if blog.description != blank %}
      <p class="text-muted-foreground text-lg" style="max-width: 32rem; margin: 0 auto;">
        {{ blog.description }}
      </p>
    {% endif %}
  </div>

  <!-- Featured Article (if available) -->
  {% assign featured_article = blog.articles.first %}
  {% if featured_article and blog.articles.size > 1 %}
    <article class="featured-article mb-16">
      <a href="{{ featured_article.url }}" class="block group" style="text-decoration: none;">
        <div class="grid grid-cols-1 lg-grid-cols-2" style="gap: 3rem; align-items: center;">
          <!-- Featured Image -->
          <div class="aspect-video overflow-hidden rounded-lg bg-muted" style="background: hsl(var(--muted));">
            {% if featured_article.image %}
              <img 
                src="{{ featured_article.image | img_url: '800x600' }}"
                alt="{{ featured_article.image.alt | default: featured_article.title }}"
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                loading="lazy"
              >
            {% else %}
              <div class="w-full h-full flex items-center justify-center">
                <i data-lucide="image" style="width: 3rem; height: 3rem; color: hsl(var(--muted-foreground));"></i>
              </div>
            {% endif %}
          </div>

          <!-- Featured Content -->
          <div>
            <div class="flex items-center mb-4" style="gap: 0.75rem;">
              <span class="badge" style="background: hsl(var(--primary)); color: white;">Destaque</span>
              <time class="text-muted-foreground text-sm">
                {{ featured_article.published_at | date: '%d de %B de %Y' }}
              </time>
            </div>
            
            <h2 class="headline text-foreground group-hover:text-primary mb-4 transition-colors" style="font-size: 2rem;">
              {{ featured_article.title }}
            </h2>
            
            {% if featured_article.excerpt != blank %}
              <p class="text-muted-foreground mb-6" style="font-size: 1.125rem; line-height: 1.6;">
                {{ featured_article.excerpt | strip_html | truncate: 200 }}
              </p>
            {% else %}
              <p class="text-muted-foreground mb-6" style="font-size: 1.125rem; line-height: 1.6;">
                {{ featured_article.content | strip_html | truncate: 200 }}
              </p>
            {% endif %}

            <div class="flex items-center justify-between">
              <div class="flex items-center" style="gap: 0.75rem;">
                <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center" style="background: hsl(var(--primary));">
                  <span class="text-white text-sm font-medium">
                    {{ featured_article.author | slice: 0 }}
                  </span>
                </div>
                <span class="text-muted-foreground text-sm">{{ featured_article.author }}</span>
              </div>
              
              <span class="text-primary font-medium group-hover:underline">
                Ler mais
                <i data-lucide="arrow-right" style="width: 1rem; height: 1rem; margin-left: 0.25rem; display: inline-block; vertical-align: middle;"></i>
              </span>
            </div>
          </div>
        </div>
      </a>
    </article>
  {% endif %}

  <!-- Articles Grid -->
  <div class="grid grid-cols-1 md-grid-cols-2 lg-grid-cols-3" style="gap: 2rem;">
    {% for article in blog.articles %}
      {% unless forloop.first and featured_article %}
        <article class="article-card group">
          <a href="{{ article.url }}" class="block" style="text-decoration: none;">
            <!-- Article Image -->
            <div class="aspect-video mb-4 overflow-hidden rounded-lg bg-muted" style="background: hsl(var(--muted));">
              {% if article.image %}
                <img 
                  src="{{ article.image | img_url: '600x400' }}"
                  alt="{{ article.image.alt | default: article.title }}"
                  class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
                  loading="lazy"
                >
              {% else %}
                <div class="w-full h-full flex items-center justify-center">
                  <i data-lucide="file-text" style="width: 2rem; height: 2rem; color: hsl(var(--muted-foreground));"></i>
                </div>
              {% endif %}
            </div>

            <!-- Article Info -->
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <time class="text-muted-foreground text-sm">
                  {{ article.published_at | date: '%d/%m/%Y' }}
                </time>
                {% if article.tags.size > 0 %}
                  <span class="badge badge-outline" style="font-size: 0.75rem;">
                    {{ article.tags.first }}
                  </span>
                {% endif %}
              </div>
              
              <h3 class="headline text-foreground group-hover:text-primary transition-colors line-clamp-2" style="font-size: 1.125rem;">
                {{ article.title }}
              </h3>
              
              {% if article.excerpt != blank %}
                <p class="text-muted-foreground text-sm line-clamp-3">
                  {{ article.excerpt | strip_html }}
                </p>
              {% else %}
                <p class="text-muted-foreground text-sm line-clamp-3">
                  {{ article.content | strip_html | truncate: 120 }}
                </p>
              {% endif %}

              <div class="flex items-center justify-between">
                <div class="flex items-center" style="gap: 0.5rem;">
                  <div class="w-6 h-6 bg-primary rounded-full flex items-center justify-center" style="background: hsl(var(--primary));">
                    <span class="text-white text-xs">
                      {{ article.author | slice: 0 }}
                    </span>
                  </div>
                  <span class="text-muted-foreground text-xs">{{ article.author }}</span>
                </div>
                
                <span class="text-primary text-sm font-medium group-hover:underline">
                  Ler mais
                </span>
              </div>
            </div>
          </a>
        </article>
      {% endunless %}
    {% endfor %}
  </div>

  <!-- Pagination -->
  {% if paginate.pages > 1 %}
    <div class="mt-12">
      {% render 'pagination', paginate: paginate %}
    </div>
  {% endif %}

  <!-- Empty State -->
  {% if blog.articles.size == 0 %}
    <div class="text-center py-16">
      <i data-lucide="book-open" style="width: 4rem; height: 4rem; color: hsl(var(--muted-foreground)); margin: 0 auto 1rem;"></i>
      <h2 class="headline text-foreground mb-2" style="font-size: 1.5rem;">Nenhum artigo encontrado</h2>
      <p class="text-muted-foreground mb-6">
        Ainda não temos artigos publicados, mas em breve teremos conteúdo interessante!
      </p>
      <a href="/" class="btn-primary">
        <i data-lucide="home" style="width: 1rem; height: 1rem; margin-right: 0.5rem;"></i>
        Voltar ao Início
      </a>
    </div>
  {% endif %}
</div>

<!-- Newsletter CTA -->
<section class="bg-muted py-16 mt-16" style="background: hsl(var(--muted));">
  <div class="container text-center">
    <h2 class="headline text-primary mb-4" style="font-size: 2rem;">Não Perca Nossas Novidades</h2>
    <p class="text-muted-foreground mb-8" style="max-width: 32rem; margin: 0 auto;">
      Receba nossos artigos, dicas de estilo e novidades diretamente no seu e-mail.
    </p>
    
    <form action="/contact#newsletter" method="post" accept-charset="UTF-8" class="newsletter-form">
      <input type="hidden" name="form_type" value="customer">
      <input type="hidden" name="utf8" value="✓">
      <input type="hidden" name="contact[tags]" value="newsletter,blog">
      
      <div class="flex max-w-md mx-auto" style="gap: 0.5rem;">
        <input 
          type="email" 
          name="contact[email]" 
          placeholder="Digite seu e-mail"
          required
          class="input flex-1"
          style="background: hsl(var(--background)); border-color: hsl(var(--border));"
        >
        <button type="submit" class="btn-primary" style="white-space: nowrap;">
          <i data-lucide="send" style="width: 1rem; height: 1rem; margin-right: 0.5rem;"></i>
          Inscrever
        </button>
      </div>
    </form>
  </div>
</section>

<style>
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.article-card {
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.article-card:hover {
  transform: translateY(-0.25rem);
  box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

.featured-article {
  position: relative;
}

.featured-article::after {
  content: '';
  position: absolute;
  bottom: -2rem;
  left: 50%;
  transform: translateX(-50%);
  width: 4rem;
  height: 1px;
  background: hsl(var(--border));
}
</style>
