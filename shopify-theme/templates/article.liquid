{% comment %}
  Article template for miçangaria blog posts
{% endcomment %}

<article class="container py-12" style="max-width: 48rem;">
  <!-- Article Header -->
  <header class="text-center mb-12">
    <!-- Breadcrumb -->
    <nav class="mb-6">
      <ul class="flex items-center justify-center" style="gap: 0.5rem; list-style: none;">
        <li>
          <a href="/" class="text-muted-foreground hover-text-primary text-sm" style="text-decoration: none; transition: color 0.3s ease;">
            Início
          </a>
        </li>
        <li class="text-muted-foreground">
          <i data-lucide="chevron-right" style="width: 1rem; height: 1rem;"></i>
        </li>
        <li>
          <a href="{{ blog.url }}" class="text-muted-foreground hover-text-primary text-sm" style="text-decoration: none; transition: color 0.3s ease;">
            {{ blog.title }}
          </a>
        </li>
        <li class="text-muted-foreground">
          <i data-lucide="chevron-right" style="width: 1rem; height: 1rem;"></i>
        </li>
        <li class="text-primary text-sm">{{ article.title | truncate: 30 }}</li>
      </ul>
    </nav>

    <!-- Tags -->
    {% if article.tags.size > 0 %}
      <div class="flex items-center justify-center mb-4" style="gap: 0.5rem;">
        {% for tag in article.tags limit: 3 %}
          <span class="badge badge-outline" style="font-size: 0.75rem;">{{ tag }}</span>
        {% endfor %}
      </div>
    {% endif %}

    <!-- Title -->
    <h1 class="headline text-primary mb-6" style="font-size: clamp(1.875rem, 4vw, 3rem); line-height: 1.2;">
      {{ article.title }}
    </h1>

    <!-- Meta Information -->
    <div class="flex items-center justify-center" style="gap: 1.5rem;">
      <div class="flex items-center" style="gap: 0.5rem;">
        <div class="w-10 h-10 bg-primary rounded-full flex items-center justify-center" style="background: hsl(var(--primary));">
          <span class="text-white font-medium">
            {{ article.author | slice: 0 }}
          </span>
        </div>
        <div class="text-left">
          <p class="text-foreground font-medium text-sm" style="margin: 0;">{{ article.author }}</p>
          <p class="text-muted-foreground text-xs" style="margin: 0;">Autor</p>
        </div>
      </div>
      
      <div class="text-left">
        <p class="text-foreground font-medium text-sm" style="margin: 0;">
          {{ article.published_at | date: '%d de %B de %Y' }}
        </p>
        <p class="text-muted-foreground text-xs" style="margin: 0;">Publicado</p>
      </div>
      
      <div class="text-left">
        <p class="text-foreground font-medium text-sm" style="margin: 0;">
          {{ article.content | strip_html | size | divided_by: 200 | plus: 1 }} min
        </p>
        <p class="text-muted-foreground text-xs" style="margin: 0;">Leitura</p>
      </div>
    </div>
  </header>

  <!-- Featured Image -->
  {% if article.image %}
    <div class="aspect-video mb-12 overflow-hidden rounded-lg">
      <img 
        src="{{ article.image | img_url: '1200x800' }}"
        alt="{{ article.image.alt | default: article.title }}"
        class="w-full h-full object-cover"
        loading="lazy"
      >
    </div>
  {% endif %}

  <!-- Article Content -->
  <div class="prose prose-lg max-w-none">
    {{ article.content }}
  </div>

  <!-- Article Footer -->
  <footer class="mt-16 pt-8 border-t" style="border-color: hsl(var(--border));">
    <!-- Tags -->
    {% if article.tags.size > 0 %}
      <div class="mb-8">
        <h3 class="headline text-foreground mb-4" style="font-size: 1.125rem;">Tags</h3>
        <div class="flex flex-wrap" style="gap: 0.5rem;">
          {% for tag in article.tags %}
            <a href="{{ blog.url }}/tagged/{{ tag | handle }}" class="badge badge-outline hover-bg-primary hover-text-white" style="text-decoration: none; transition: all 0.3s ease;">
              {{ tag }}
            </a>
          {% endfor %}
        </div>
      </div>
    {% endif %}

    <!-- Share Buttons -->
    <div class="mb-8">
      <h3 class="headline text-foreground mb-4" style="font-size: 1.125rem;">Compartilhar</h3>
      <div class="flex" style="gap: 0.75rem;">
        <a 
          href="https://www.facebook.com/sharer/sharer.php?u={{ shop.url }}{{ article.url }}"
          target="_blank"
          class="p-3 bg-muted rounded-lg hover-bg-primary hover-text-white transition-colors"
          style="text-decoration: none; background: hsl(var(--muted));"
        >
          <i data-lucide="facebook" style="width: 1.25rem; height: 1.25rem;"></i>
        </a>
        <a 
          href="https://twitter.com/intent/tweet?text={{ article.title | url_encode }}&url={{ shop.url }}{{ article.url }}"
          target="_blank"
          class="p-3 bg-muted rounded-lg hover-bg-primary hover-text-white transition-colors"
          style="text-decoration: none; background: hsl(var(--muted));"
        >
          <i data-lucide="twitter" style="width: 1.25rem; height: 1.25rem;"></i>
        </a>
        <a 
          href="https://api.whatsapp.com/send?text={{ article.title | url_encode }}%20{{ shop.url }}{{ article.url }}"
          target="_blank"
          class="p-3 bg-muted rounded-lg hover-bg-primary hover-text-white transition-colors"
          style="text-decoration: none; background: hsl(var(--muted));"
        >
          <i data-lucide="message-circle" style="width: 1.25rem; height: 1.25rem;"></i>
        </a>
        <button 
          onclick="navigator.clipboard.writeText(window.location.href); this.innerHTML='<i data-lucide=&quot;check&quot; style=&quot;width: 1.25rem; height: 1.25rem;&quot;></i>'; setTimeout(() => { this.innerHTML='<i data-lucide=&quot;link&quot; style=&quot;width: 1.25rem; height: 1.25rem;&quot;></i>'; }, 2000);"
          class="p-3 bg-muted rounded-lg hover-bg-primary hover-text-white transition-colors"
          style="background: hsl(var(--muted)); border: none; cursor: pointer;"
        >
          <i data-lucide="link" style="width: 1.25rem; height: 1.25rem;"></i>
        </button>
      </div>
    </div>

    <!-- Navigation -->
    <div class="grid grid-cols-1 md-grid-cols-2" style="gap: 1rem;">
      {% if blog.previous_article %}
        <a href="{{ blog.previous_article.url }}" class="card p-6 group" style="text-decoration: none; transition: transform 0.3s ease, box-shadow 0.3s ease;">
          <div class="flex items-center mb-2" style="gap: 0.5rem;">
            <i data-lucide="arrow-left" style="width: 1rem; height: 1rem; color: hsl(var(--muted-foreground));"></i>
            <span class="text-muted-foreground text-sm">Artigo anterior</span>
          </div>
          <h4 class="headline text-foreground group-hover:text-primary transition-colors" style="font-size: 1rem; margin: 0;">
            {{ blog.previous_article.title | truncate: 50 }}
          </h4>
        </a>
      {% endif %}

      {% if blog.next_article %}
        <a href="{{ blog.next_article.url }}" class="card p-6 group text-right" style="text-decoration: none; transition: transform 0.3s ease, box-shadow 0.3s ease;">
          <div class="flex items-center justify-end mb-2" style="gap: 0.5rem;">
            <span class="text-muted-foreground text-sm">Próximo artigo</span>
            <i data-lucide="arrow-right" style="width: 1rem; height: 1rem; color: hsl(var(--muted-foreground));"></i>
          </div>
          <h4 class="headline text-foreground group-hover:text-primary transition-colors" style="font-size: 1rem; margin: 0;">
            {{ blog.next_article.title | truncate: 50 }}
          </h4>
        </a>
      {% endif %}
    </div>
  </footer>
</article>

<!-- Related Articles -->
{% assign related_articles = blog.articles | where: 'id', '!=', article.id | limit: 3 %}
{% if related_articles.size > 0 %}
  <section class="bg-muted py-16" style="background: hsl(var(--muted));">
    <div class="container">
      <div class="text-center mb-12">
        <h2 class="headline text-primary mb-4" style="font-size: 2rem;">Artigos Relacionados</h2>
        <p class="text-muted-foreground">
          Continue lendo sobre temas relacionados
        </p>
      </div>

      <div class="grid grid-cols-1 md-grid-cols-3" style="gap: 2rem;">
        {% for related_article in related_articles %}
          <article class="card group">
            <a href="{{ related_article.url }}" class="block" style="text-decoration: none;">
              {% if related_article.image %}
                <div class="aspect-video mb-4 overflow-hidden rounded-lg">
                  <img 
                    src="{{ related_article.image | img_url: '400x300' }}"
                    alt="{{ related_article.title }}"
                    class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
                    loading="lazy"
                  >
                </div>
              {% endif %}

              <div class="space-y-3">
                <time class="text-muted-foreground text-sm">
                  {{ related_article.published_at | date: '%d/%m/%Y' }}
                </time>
                
                <h3 class="headline text-foreground group-hover:text-primary transition-colors line-clamp-2" style="font-size: 1.125rem;">
                  {{ related_article.title }}
                </h3>
                
                <p class="text-muted-foreground text-sm line-clamp-2">
                  {{ related_article.excerpt | default: related_article.content | strip_html | truncate: 100 }}
                </p>

                <span class="text-primary text-sm font-medium group-hover:underline">
                  Ler artigo
                  <i data-lucide="arrow-right" style="width: 0.875rem; height: 0.875rem; margin-left: 0.25rem; display: inline-block; vertical-align: middle;"></i>
                </span>
              </div>
            </a>
          </article>
        {% endfor %}
      </div>
    </div>
  </section>
{% endif %}

<style>
.prose {
  line-height: 1.7;
}

.prose h2 {
  font-family: var(--font-headline);
  color: hsl(var(--primary));
  font-size: 1.5rem;
  margin: 2rem 0 1rem;
  font-weight: 600;
}

.prose h3 {
  font-family: var(--font-headline);
  color: hsl(var(--foreground));
  font-size: 1.25rem;
  margin: 1.5rem 0 0.75rem;
  font-weight: 600;
}

.prose p {
  margin: 1rem 0;
  color: hsl(var(--foreground));
}

.prose a {
  color: hsl(var(--primary));
  text-decoration: underline;
  transition: color 0.3s ease;
}

.prose a:hover {
  color: hsl(var(--primary) / 0.8);
}

.prose ul, .prose ol {
  margin: 1rem 0;
  padding-left: 1.5rem;
}

.prose li {
  margin: 0.5rem 0;
  color: hsl(var(--foreground));
}

.prose blockquote {
  border-left: 4px solid hsl(var(--primary));
  padding-left: 1rem;
  margin: 1.5rem 0;
  font-style: italic;
  color: hsl(var(--muted-foreground));
}

.prose img {
  margin: 2rem 0;
  border-radius: 0.5rem;
  max-width: 100%;
  height: auto;
}

.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
</style>
